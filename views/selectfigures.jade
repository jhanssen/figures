ul(id="results")
  include ./listfigurespartial.jade

script.
  var selector = !{selector};
  var selected = !{JSON.stringify(figureSelected)};

  var input = document.getElementById("inputSearch");
  input.onkeyup = function(e) {
    var req = new XMLHttpRequest();
    req.onreadystatechange = function() {
      if (req.readyState==4 && req.status==200) {
        var ul = document.getElementById("results");
        ul.innerHTML = req.responseText;
      }
    };
    var q = '/figures/list/figures?search=' + input.value;
    if (selector) {
      // toggle things
      var inputs = document.getElementsByTagName('input');
      for (var i = 0; i < inputs.length; ++i) {
        var field = inputs[i];
        if (field.type === "checkbox") {
          selected[field.id] = field.checked;
        }
      }

      q += '&selector&selected=' + JSON.stringify(selected);
    }
    req.open('GET', q);
    req.send();
  };
